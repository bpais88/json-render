@import "tailwindcss";
@import "@xyflow/react/dist/style.css";

/* =============================================================================
   Base Theme (dark)
   ============================================================================= */

@theme {
  --color-background: oklch(0.145 0 0);
  --color-foreground: oklch(0.985 0 0);
  --color-muted: oklch(0.269 0 0);
  --color-muted-foreground: oklch(0.708 0 0);
  --color-border: oklch(0.269 0 0);
  --color-primary: oklch(0.922 0 0);
  --color-primary-foreground: oklch(0.205 0 0);
  --color-accent: oklch(0.65 0.2 250);
  --color-accent-foreground: oklch(0.985 0 0);
  --radius: 0.625rem;
}

* {
  border-color: var(--color-border);
}

body {
  background: var(--color-background);
  color: var(--color-foreground);
  font-family: var(--font-geist-sans), system-ui, sans-serif;
}

/* =============================================================================
   COMIC THEME
   ============================================================================= */

.comic-theme {
  --color-background: oklch(0.95 0.01 80);
  --color-foreground: oklch(0.15 0.01 260);
  --color-muted: oklch(0.9 0.01 80);
  --color-muted-foreground: oklch(0.45 0.02 260);
  --color-border: oklch(0.2 0.01 260);
  --color-primary: oklch(0.55 0.2 25);
  --color-primary-foreground: oklch(0.98 0 0);
  --color-panel-bg: oklch(0.98 0.005 80);
  background: oklch(0.95 0.01 80);
  color: oklch(0.15 0.01 260);
  font-family: var(--font-geist-sans), "Comic Sans MS", cursive, system-ui;
}

.comic-theme .comic-panel {
  background: var(--color-panel-bg);
  border: 3px solid var(--color-border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  box-shadow: 4px 4px 0 oklch(0.2 0.01 260 / 0.15);
  animation: panelIn 0.3s ease-out;
}

.comic-theme .speech-bubble {
  position: relative;
  background: white;
  border: 2.5px solid var(--color-border);
  border-radius: 18px;
  padding: 10px 14px;
  max-width: 85%;
}

.comic-theme .speech-bubble::after {
  content: "";
  position: absolute;
  bottom: -12px;
  left: 20px;
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  border-top: 14px solid white;
  filter: drop-shadow(0 2px 0 var(--color-border));
}

.comic-theme .speech-bubble::before {
  content: "";
  position: absolute;
  bottom: -15px;
  left: 19px;
  width: 0;
  height: 0;
  border-left: 13px solid transparent;
  border-right: 13px solid transparent;
  border-top: 16px solid var(--color-border);
}

.comic-theme .thought-bubble {
  position: relative;
  background: white;
  border: 2.5px solid var(--color-border);
  border-radius: 24px;
  padding: 10px 14px;
  max-width: 85%;
}

.comic-theme .thought-bubble::after {
  content: "";
  position: absolute;
  bottom: -18px;
  left: 24px;
  width: 10px;
  height: 10px;
  background: white;
  border: 2px solid var(--color-border);
  border-radius: 50%;
}

.comic-theme .thought-bubble .thought-dot {
  position: absolute;
  bottom: -28px;
  left: 20px;
  width: 6px;
  height: 6px;
  background: white;
  border: 2px solid var(--color-border);
  border-radius: 50%;
}

.comic-theme .narration-box {
  background: oklch(0.92 0.03 80);
  border: 2px solid var(--color-border);
  padding: 8px 12px;
  font-style: italic;
}

.comic-theme .sfx-text {
  font-weight: 900;
  font-style: italic;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  text-shadow: 2px 2px 0 oklch(0.2 0.01 260 / 0.2);
  transform: rotate(-3deg);
}

@keyframes panelIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

/* =============================================================================
   WIREFRAME THEME
   ============================================================================= */

.wireframe-theme {
  background-color: #ffffff;
  background-image: repeating-linear-gradient(
      0deg, transparent, transparent 19px, #e5e5e5 19px, #e5e5e5 20px
    ),
    repeating-linear-gradient(
      90deg, transparent, transparent 19px, #e5e5e5 19px, #e5e5e5 20px
    );
  background-size: 20px 20px;
  color: #1a1a1a;
  font-family: var(--font-geist-mono), ui-monospace, monospace;
}

.wireframe-theme .wf-screen {
  border: 2px dashed #9ca3af;
  border-radius: 8px;
  background: white;
  overflow: hidden;
  box-shadow: 4px 4px 0 #e5e7eb;
  animation: wfFadeIn 0.4s ease-out;
}

.wireframe-theme .wf-screen-header {
  border-bottom: 2px dashed #d1d5db;
  padding: 8px 12px;
  background: #fafafa;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.wireframe-theme .wf-screen-body {
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.wireframe-theme .wf-navbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 16px;
  border: 1px dashed #d1d5db;
  border-radius: 4px;
  background: #fafafa;
}

.wireframe-theme .wf-sidebar {
  border: 1px dashed #d1d5db;
  border-radius: 4px;
  padding: 8px;
  background: #fafafa;
  min-width: 160px;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.wireframe-theme .wf-sidebar-item {
  padding: 6px 8px;
  font-size: 12px;
  color: #374151;
  border-radius: 3px;
  cursor: pointer;
  display: flex;
  align-items: center;
}

.wireframe-theme .wf-sidebar-active {
  background: #e5e7eb;
  color: #1f2937;
  font-weight: 600;
}

.wireframe-theme .wf-input {
  border: 2px dashed #d1d5db;
  border-radius: 4px;
  padding: 8px 12px;
  font-size: 13px;
  background: white;
}

.wireframe-theme .wf-btn {
  display: inline-flex;
  align-items: center;
  border-radius: 4px;
  font-weight: 600;
  cursor: pointer;
  border: 2px dashed transparent;
}

.wireframe-theme .wf-btn-primary { background: #404040; color: white; border-color: #404040; }
.wireframe-theme .wf-btn-secondary { background: #e5e7eb; color: #374151; border-color: #d1d5db; }
.wireframe-theme .wf-btn-outline { background: white; color: #374151; border-color: #9ca3af; border-style: dashed; }
.wireframe-theme .wf-btn-danger { background: #fecaca; color: #dc2626; border-color: #fca5a5; }
.wireframe-theme .wf-btn-ghost { background: transparent; color: #374151; text-decoration: underline; text-decoration-style: dashed; }

.wireframe-theme .wf-card {
  border: 2px dashed #d1d5db;
  border-radius: 6px;
  padding: 16px;
  background: white;
}

.wireframe-theme .wf-table-wrapper { border: 1px dashed #d1d5db; border-radius: 4px; overflow: hidden; }
.wireframe-theme .wf-th { text-align: left; padding: 8px 12px; font-size: 11px; font-weight: 700; color: #374151; text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px dashed #d1d5db; background: #fafafa; }
.wireframe-theme .wf-td { padding: 8px 12px; border-bottom: 1px dashed #e5e7eb; }

.wireframe-theme .wf-img {
  position: relative;
  border: 2px dashed #d1d5db;
  border-radius: 4px;
  background: #f9fafb;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.wireframe-theme .wf-modal-backdrop {
  position: relative;
  border: 2px dashed #9ca3af;
  border-radius: 6px;
  background: repeating-linear-gradient(45deg, #f3f4f6, #f3f4f6 5px, #e5e7eb 5px, #e5e7eb 6px);
  padding: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.wireframe-theme .wf-modal { width: 100%; border: 2px dashed #9ca3af; border-radius: 6px; background: white; padding: 16px; box-shadow: 4px 4px 0 #d1d5db; }

.wireframe-theme .wf-toast {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  border: 1px dashed #d1d5db;
  border-left: 4px solid;
  border-radius: 4px;
  padding: 8px 12px;
  background: white;
  max-width: 320px;
  margin-left: auto;
}

.wireframe-theme .wf-annotation {
  display: inline-block;
  font-size: 11px;
  font-weight: 500;
  padding: 6px 10px;
  border: 1px dashed;
  border-radius: 2px;
  transform: rotate(-1deg);
  box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.05);
}

@keyframes wfFadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

/* =============================================================================
   MERMAID THEME
   ============================================================================= */

.mermaid-theme {
  background: oklch(0.13 0.01 260);
  color: oklch(0.93 0.01 260);
}

.mermaid-theme .diagram-card {
  border: 1px solid oklch(0.25 0.01 260);
  border-radius: 8px;
  background: oklch(0.15 0.01 260);
  overflow: hidden;
  animation: mermaidFadeIn 0.4s ease-out;
}

.mermaid-theme .diagram-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border-bottom: 1px solid oklch(0.25 0.01 260);
  background: oklch(0.17 0.01 260);
}

.mermaid-theme .diagram-body {
  padding: 24px;
  display: flex;
  justify-content: center;
  min-height: 120px;
}

.mermaid-theme .diagram-footer {
  padding: 8px 16px;
  border-top: 1px solid oklch(0.2 0.01 260);
}

.mermaid-theme .mermaid-svg-container svg {
  max-width: 100%;
  height: auto;
}

@keyframes mermaidFadeIn {
  from { opacity: 0; transform: translateY(8px); }
  to { opacity: 1; transform: translateY(0); }
}

/* =============================================================================
   ADVENTURE THEME
   ============================================================================= */

.adventure-theme {
  --color-background: oklch(0.12 0.01 260);
  --color-foreground: oklch(0.93 0.01 80);
  --color-muted: oklch(0.2 0.01 260);
  --color-muted-foreground: oklch(0.6 0.02 80);
  --color-border: oklch(0.25 0.02 260);
  --color-primary: oklch(0.75 0.15 80);
  --color-primary-foreground: oklch(0.15 0.01 260);
  background: oklch(0.12 0.01 260);
  color: oklch(0.93 0.01 80);
  font-family: var(--font-geist-sans), Georgia, serif;
}

.adventure-theme .narrative-text {
  animation: adventureFadeIn 0.4s ease-out;
}

.adventure-theme .choice-button {
  transition: all 0.2s ease;
}

.adventure-theme .choice-button:hover {
  box-shadow: 0 0 20px oklch(0.75 0.15 80 / 0.15);
}

.adventure-theme .game-frame {
  background:
    radial-gradient(ellipse at 30% 20%, oklch(0.18 0.015 260) 0%, transparent 60%),
    radial-gradient(ellipse at 70% 80%, oklch(0.16 0.02 280) 0%, transparent 50%),
    oklch(0.12 0.01 260);
}

.adventure-theme .stat-value {
  text-shadow: 0 0 8px currentColor;
}

@keyframes adventureFadeIn {
  from { opacity: 0; transform: translateY(4px); }
  to { opacity: 1; transform: translateY(0); }
}

/* =============================================================================
   SLIDES THEME
   ============================================================================= */

.slides-theme {
  background: oklch(0.145 0 0);
  color: oklch(0.985 0 0);
}

.slides-theme .slide {
  aspect-ratio: 16 / 9;
  container-type: inline-size;
}

.slides-theme .slide * {
  transition: opacity 0.2s ease;
}

@container (min-width: 600px) {
  .slides-theme .slide-title { font-size: 3cqi; }
  .slides-theme .slide-subtitle { font-size: 1.8cqi; }
  .slides-theme .slide-text { font-size: 1.4cqi; }
  .slides-theme .slide-bullet { font-size: 1.3cqi; }
  .slides-theme .slide-code { font-size: 1.1cqi; }
  .slides-theme .slide-quote { font-size: 1.6cqi; }
  .slides-theme .slide-badge { font-size: 1cqi; }
}

@container (max-width: 599px) {
  .slides-theme .slide-title { font-size: 1.5rem; }
  .slides-theme .slide-subtitle { font-size: 1.1rem; }
  .slides-theme .slide-text { font-size: 0.9rem; }
  .slides-theme .slide-bullet { font-size: 0.85rem; }
  .slides-theme .slide-code { font-size: 0.75rem; }
  .slides-theme .slide-quote { font-size: 1rem; }
  .slides-theme .slide-badge { font-size: 0.7rem; }
}

.slides-theme .fullscreen-mode {
  position: fixed;
  inset: 0;
  z-index: 9999;
  background: black;
  display: flex;
  align-items: center;
  justify-content: center;
  touch-action: pan-y;
  -webkit-user-select: none;
  user-select: none;
}

.slides-theme .fullscreen-mode .slide {
  width: 100vw;
  height: 100vh;
  aspect-ratio: auto;
}

/* Landscape-specific: maximise slide area */
@media (orientation: landscape) and (max-height: 500px) {
  .slides-theme .fullscreen-mode .slide {
    width: 100vw;
    height: 100vh;
  }
}

/* =============================================================================
   DIAGRAMS THEME
   ============================================================================= */

.diagrams-theme {
  background: oklch(0.145 0 0);
  color: oklch(0.985 0 0);
}

.diagrams-theme .react-flow__background {
  background: oklch(0.145 0 0) !important;
}

.diagrams-theme .react-flow__minimap {
  background: oklch(0.18 0 0) !important;
  border: 1px solid oklch(0.25 0.005 260) !important;
  border-radius: 8px !important;
}

.diagrams-theme .react-flow__controls {
  border: 1px solid oklch(0.25 0.005 260) !important;
  border-radius: 8px !important;
  overflow: hidden;
}

.diagrams-theme .react-flow__controls-button {
  background: oklch(0.18 0 0) !important;
  border-bottom-color: oklch(0.25 0.005 260) !important;
  fill: oklch(0.65 0 0) !important;
}

.diagrams-theme .react-flow__controls-button:hover {
  background: oklch(0.25 0 0) !important;
}

.diagrams-theme .react-flow__edge-path {
  stroke: oklch(0.5 0.05 250) !important;
  stroke-width: 2 !important;
}

.diagrams-theme .react-flow__edge.animated .react-flow__edge-path {
  stroke-dasharray: 5;
  animation: diagramDash 0.5s linear infinite;
}

@keyframes diagramDash {
  to { stroke-dashoffset: -10; }
}

/* =============================================================================
   REMOTION THEME
   ============================================================================= */

.remotion-theme {
  background: oklch(0.145 0 0);
  color: oklch(0.985 0 0);
}

/* =============================================================================
   SAFE AREA SUPPORT (notched phones)
   ============================================================================= */

@supports (padding: max(0px)) {
  body {
    padding-left: max(0px, env(safe-area-inset-left));
    padding-right: max(0px, env(safe-area-inset-right));
    padding-bottom: max(0px, env(safe-area-inset-bottom));
  }
}
